{
  "name": "amd-optimize",
  "version": "0.0.2",
  "description": "An AMD (i.e. RequireJS) optimizer that's stream-friendly. Made for gulp. (WIP)",
  "main": "lib/index.js",
  "scripts": {
    "test": "gulp test"
  },
  "repository": {
    "type": "git",
    "url": "git://github.com/scalableminds/amd-optimize.git"
  },
  "keywords": [
    "gulpplugin",
    "gulpfriendly"
  ],
  "author": {
    "name": "Norman Rzepka",
    "email": "norman@scm.io",
    "url": "http://scm.io"
  },
  "license": "MIT",
  "dependencies": {
    "async": "~0.2.10",
    "lodash": "~2.4.1",
    "vinyl": "~0.2.3",
    "vinyl-fs": "0.0.2",
    "acorn": "~0.5.0",
    "ast-types": "~0.3.16",
    "escodegen": "~1.2.0",
    "through2": "~0.4.1"
  },
  "devDependencies": {
    "gulp-concat": "~2.1.7",
    "gulp-mocha": "~0.4.1",
    "gulp": "~3.5.5",
    "gulp-coffee": "~1.4.1",
    "coffee-script": "~1.7.1",
    "gulp-if": "0.0.5",
    "gulp-util": "~2.2.14",
    "gulp-uglify": "~0.2.1"
  },
  "readme": "# amd-optimize [![Build Status](https://drone.io/github.com/scalableminds/amd-optimize/status.png)](https://drone.io/github.com/scalableminds/amd-optimize/latest)\n\n> An AMD ([RequireJS](http://requirejs.org/)) optimizer that's stream-friendly. Made for [gulp](http://gulpjs.com/). (WIP)\n\n# Features\n\n* Trace all dependencies of an AMD module\n* Stream-friendly: Pipe in files and get an ordered stream of files out. No need for writing on disk in between.\n* Support for precompilation of source files (ie. CoffeeScript)\n* Wraps non-AMD dependencies\n* Supply a custom loader for on-demand loading\n* Leaves concatenation and minification to your preferred choice of modules\n\n# Example\n\n```js\nvar gulp = require(\"gulp\");\nvar amdOptimize = require(\"amd-optimize\");\n\n\n// Main module. With CoffeeScript precompilation, concatenation and minifiying.\ngulp.task(\"scripts:index\", function () {\n\n  return gulp.src(\"src/scripts/**/*.js\")\n    // Traces all modules and outputs them in the correct order.\n    .pipe(amdOptimize(\"main\"))\n    .pipe(concat(\"index.js\"))\n    .pipe(gulp.dest(\"dist/scripts\"));\n\n});\n```\n\n# Motivation\nThis aims to be an alternative to the powerful [r.js](https://github.com/jrburke/r.js) optimizer, but made for a streaming environment like [gulp](http://gulpjs.com/). This implementation doesn't operate on the file system directly. So, there's no need for complicated setups when dealing with precompiled files. Also, this module only focuses on tracing modules and does not intend replace a full-fletched build system. Therefore, there might be tons of use cases where r.js is a better fit.\n\n\n# Installation\n\n```bash\n$ npm install amd-optimize\n```\n\n\n## API\n\n### amdOptimize(moduleName, [options])\n\n#### moduleName\nType: `String`\n\n#### options.paths\n\n```js\npaths : {\n  \"backbone\" : \"../bower_components/backbone/backbone\",\n  \"jquery\" : \"../bower_components/jquery/jquery\"\n}\n```\n\n#### options.map\n\n```js\nmap : {\n  // Replace underscore with lodash for the backbone module\n  \"backbone\" : {\n    \"underscore\" : \"lodash\"\n  }\n}\n```\n\n#### options.shim\n\n```js\nshim : {\n  // Shimmed export. Specify the variable name that is being exported.\n  \"three\" : {\n     exports : \"THREE\"\n  },\n\n  // Shimmed dependecies and export\n  \"three.color\" : {\n     deps : [\"three\"],\n     exports : \"THREE.ColorConverter\"\n  },\n\n  // Shimmed dependencies\n  \"bootstrap\" : [\"jquery\"]\n}\n```\n\n#### options.configFile\nType: `Stream` or `String`\n\nSupply a filepath (can be a glob) or a gulp stream to your config file that lists all your paths, shims and maps.\n\n```js\namdOptimize.src(\"index\", {\n  configFile : \"src/scripts/require_config.js\"\n});\n\namdOptimize.src(\"index\", {\n  configFile : gulp.src(\"src/scripts/require_config.coffee\").pipe(coffee())\n});\n```\n\n#### options.findNestedDependencies\nType: `Boolean`  \nDefault: `false`\n\n\nIf `true` it will trace `require()` dependencies inside of top-level `require()` or `define()` calls. Usually, these nested dependencies are considered dynamic or runtime calls, so it's disabled by default.\n\nWould trace both `router` and `controllers/home`:\n\n```js\ndefine(\"router\", [], function () {\n  return {\n    \"/home\" : function () {\n      require([\"controllers/home\"]);\n    },\n    ...\n  }\n})\n```\n\n#### options.baseUrl\n#### options.exclude\n#### options.include\n\n#### options.wrapShim\n\nType: `Boolean`  \nDefault: `false`\n\nIf `true` all files that you have declared a shim for and don't have a proper `define()` call will be wrapped in a `define()` call.\n\n\n\n```js\n// Original\nvar test = \"Test\";\n\n// Output\ndefine(\"test\", [], function () {\n  var test = \"Test\";\n  return test;\n});\n\n// Shim config\nshim : {\n  test : {\n    exports : \"test\"\n  }\n}\n```\n\n#### options.loader\nWIP. Subject to change.\n\n```js\namdOptimize.src(\n  \"index\",\n  loader : amdOptimize.loader(\n    // Used for turning a moduleName into a filepath glob.\n    function (moduleName) { return \"src/scripts/\" + moduleName + \".coffee\" },\n    // Returns a transform stream.\n    function () { return coffee(); }\n  )\n)\n```\n\n### amdOptimize.src(moduleName, options)\nSame as `amdOptimize()`, but won't accept an input stream. Instead it will rely on loading the files by itself.\n\n\n## Algorithms\n### Resolving paths\n\n### Finding files\n1. Check the input stream.\n2. Look for files with the default loader and `baseUrl`.\n3. Look for files with the custom loader and its transform streams.\n4. Give up.\n\n\n## Recommended modules\n* [gulp-concat](https://www.npmjs.org/package/gulp-concat/): Concat the output files. Because that's the whole point of module optimization, right?\n\n```js\nvar concat = require(\"gulp-concat\");\n\ngulp.src(\"src/scripts/**/*.js\")\n  .pipe(amdOptimize(\"index\"))\n  .pipe(concat(\"index.js\"))\n  .pipe(gulp.dest(\"dist\"));\n```\n\n\n* [gulp-uglify](https://www.npmjs.org/package/gulp-uglify/): Minify the output files.\n\n```js\nvar uglify = require(\"gulp-uglify\");\n\ngulp.src(\"src/scripts/**/*.js\")\n  .pipe(amdOptimize(\"index\"))\n  .pipe(concat(\"index.js\"))\n  .pipe(uglify())\n  .pipe(gulp.dest(\"dist\"));\n```\n\n\n* [gulp-coffee](https://www.npmjs.org/package/gulp-coffee/): Precompile CoffeeScript source files. Or any other [language that compiles to JS](https://github.com/jashkenas/coffee-script/wiki/List-of-languages-that-compile-to-JS).\n\n```js\nvar coffee = require(\"gulp-coffee\");\n\ngulp.src(\"src/scripts/**/*.coffee\")\n  .pipe(coffee())\n  .pipe(amdOptimize(\"index\"))\n  .pipe(concat(\"index.js\"))\n  .pipe(gulp.dest(\"dist\"));\n```\n\n\n* [gulp-if](https://www.npmjs.org/package/gulp-if/): Conditionally pipe files through a transform stream. Useful for CoffeeScript precompilation.\n\n```js\nvar gif = require(\"gulp-if\");\n\ngulp.src(\"src/scripts/**/*.{coffee,js}\")\n  .pipe(gif(function (file) { return path.extname(file) == \".coffee\"; }, coffee()))\n  .pipe(amdOptimize(\"index\"))\n  .pipe(concat(\"index.js\"))\n  .pipe(gulp.dest(\"dist\"));\n```\n\n* [event-stream](https://www.npmjs.org/package/event-stream/), [gulp-order](https://www.npmjs.org/package/gulp-order): Add files before or after\n\n```js\nvar eventStream = require(\"event-stream\");\nvar order = require(\"gulp-order\");\n\neventStream.merge(\n  gulp.src(\"bower_components/almond/almond.js\"),\n  gulp.src(amdOptimize(\"index\"))\n    .pipe(concat(\"index.js\"))\n)\n  .pipe(order([\"**/almond.js\", \"**/index.js\"]))\n  .pipe(concat(\"index.js\"))\n  .pipe(gulp.dest(\"dist\"));\n\n```\n\n## Current limitations\n* No [sourcemaps](http://requirejs.org/docs/optimization.html#sourcemaps).\n* No [RequireJS plugins](http://requirejs.org/docs/api.html#plugins).\n* No [`exclude` or `include` configuration](http://requirejs.org/docs/optimization.html#basics).\n* No [CommonJS module definitions](http://requirejs.org/docs/whyamd.html#sugar).\n\n## Tests\n1. Install npm dev dependencies `npm install`\n2. Install gulp globally `npm install -g gulp`\n3. Run `gulp test`\n\n## License\nMIT &copy; scalable minds 2014\n\n",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/scalableminds/amd-optimize/issues"
  },
  "homepage": "https://github.com/scalableminds/amd-optimize",
  "_id": "amd-optimize@0.0.2",
  "_from": "amd-optimize@"
}
